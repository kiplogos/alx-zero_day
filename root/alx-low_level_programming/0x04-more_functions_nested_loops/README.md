more functions and nestedd loops
